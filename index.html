<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Lane County GIS Property Explorer - Interactive property lookup and management tool">
    <title>Lane County GIS Property Explorer</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin="anonymous">
    
    <!-- FontAwesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" 
          integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" 
          crossorigin="anonymous">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Main Application Container -->
    <div id="app-container">
        
        <!-- Sidebar: Saved Properties Panel -->
        <aside id="sidebar" class="sidebar">
            <!-- Sidebar Header -->
            <div class="sidebar-header">
                <div class="sidebar-title">
                    <i class="fas fa-bookmark"></i>
                    <h2>Saved Properties</h2>
                </div>
                <button id="sidebar-toggle" class="sidebar-toggle" aria-label="Toggle Sidebar">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>
            
            <!-- Sidebar Actions -->
            <div class="sidebar-actions">
                <button id="btn-export-all" class="btn btn-primary" disabled>
                    <i class="fas fa-download"></i>
                    <span>Export All</span>
                </button>
                <button id="btn-export-selected" class="btn btn-secondary" disabled>
                    <i class="fas fa-file-export"></i>
                    <span>Export Selected</span>
                </button>
                <button id="btn-clear-all" class="btn btn-danger" disabled>
                    <i class="fas fa-trash-alt"></i>
                    <span>Clear All</span>
                </button>
            </div>
            
            <!-- Select All Checkbox -->
            <div class="sidebar-select-all">
                <label class="checkbox-container">
                    <input type="checkbox" id="select-all-checkbox">
                    <span class="checkmark"></span>
                    <span class="label-text">Select All</span>
                </label>
                <span id="property-count" class="property-count">0 properties</span>
            </div>
            
            <!-- Saved Properties List -->
            <div id="saved-properties-list" class="saved-properties-list">
                <!-- Empty State -->
                <div id="empty-state" class="empty-state">
                    <i class="fas fa-map-marked-alt"></i>
                    <p>No properties saved yet</p>
                    <span>Click on the map or search to find and save properties</span>
                </div>
                <!-- Property cards will be dynamically inserted here -->
            </div>
        </aside>
        
        <!-- Main Map Container -->
        <main id="map-container">
            <!-- The Leaflet Map -->
            <div id="map"></div>
            
            <!-- Search Panel -->
            <div id="search-panel" class="search-panel">
                <!-- Search Type Tabs -->
                <div class="search-tabs">
                    <button class="search-tab active" data-search-type="address" title="Search by Address">
                        <i class="fas fa-home"></i>
                        <span>Address</span>
                    </button>
                    <button class="search-tab" data-search-type="taxlot" title="Search by Tax Lot">
                        <i class="fas fa-hashtag"></i>
                        <span>Tax Lot</span>
                    </button>
                    <button class="search-tab" data-search-type="owner" title="Search by Owner Name">
                        <i class="fas fa-user"></i>
                        <span>Owner</span>
                    </button>
                    <button class="search-tab" data-search-type="coordinates" title="Search by Coordinates">
                        <i class="fas fa-crosshairs"></i>
                        <span>Coords</span>
                    </button>
                </div>
                
                <!-- Search Input Area -->
                <div class="search-input-wrapper">
                    <!-- Address Search (Default) -->
                    <div id="search-address" class="search-input-group active">
                        <div class="search-input-container">
                            <i class="fas fa-search search-icon"></i>
                            <input 
                                type="text" 
                                id="input-address" 
                                class="search-input" 
                                placeholder="Enter street address (e.g., 123 Main St, Eugene)"
                                autocomplete="off"
                                spellcheck="false"
                            >
                            <button id="btn-clear-address" class="search-clear-btn hidden" title="Clear">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <button id="btn-search-address" class="btn btn-search">
                            <i class="fas fa-search"></i>
                            <span>Search</span>
                        </button>
                    </div>
                    
                    <!-- Tax Lot Search -->
                    <div id="search-taxlot" class="search-input-group">
                        <div class="search-input-container">
                            <i class="fas fa-hashtag search-icon"></i>
                            <input 
                                type="text" 
                                id="input-taxlot" 
                                class="search-input" 
                                placeholder="Enter tax lot ID (e.g., 1234567)"
                                autocomplete="off"
                                spellcheck="false"
                            >
                            <button id="btn-clear-taxlot" class="search-clear-btn hidden" title="Clear">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <button id="btn-search-taxlot" class="btn btn-search">
                            <i class="fas fa-search"></i>
                            <span>Search</span>
                        </button>
                    </div>
                    
                    <!-- Owner Search -->
                    <div id="search-owner" class="search-input-group">
                        <div class="search-input-container">
                            <i class="fas fa-user search-icon"></i>
                            <input 
                                type="text" 
                                id="input-owner" 
                                class="search-input" 
                                placeholder="Enter owner name (e.g., Smith, John)"
                                autocomplete="off"
                                spellcheck="false"
                            >
                            <button id="btn-clear-owner" class="search-clear-btn hidden" title="Clear">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <button id="btn-search-owner" class="btn btn-search">
                            <i class="fas fa-search"></i>
                            <span>Search</span>
                        </button>
                    </div>
                    
                    <!-- Coordinates Search -->
                    <div id="search-coordinates" class="search-input-group">
                        <div class="search-coords-inputs">
                            <div class="search-input-container coord-input">
                                <label for="input-lat">Lat</label>
                                <input 
                                    type="text" 
                                    id="input-lat" 
                                    class="search-input" 
                                    placeholder="44.0521"
                                    autocomplete="off"
                                    spellcheck="false"
                                >
                            </div>
                            <div class="search-input-container coord-input">
                                <label for="input-lng">Lng</label>
                                <input 
                                    type="text" 
                                    id="input-lng" 
                                    class="search-input" 
                                    placeholder="-123.0868"
                                    autocomplete="off"
                                    spellcheck="false"
                                >
                            </div>
                        </div>
                        <button id="btn-search-coords" class="btn btn-search">
                            <i class="fas fa-search"></i>
                            <span>Go</span>
                        </button>
                    </div>
                </div>
                
                <!-- Search Results Dropdown -->
                <div id="search-results" class="search-results hidden">
                    <div class="search-results-header">
                        <span id="results-count">0 results found</span>
                        <button id="btn-close-results" class="btn-close-results" title="Close">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <ul id="results-list" class="results-list">
                        <!-- Search result items will be inserted here -->
                    </ul>
                    <div id="results-empty" class="results-empty hidden">
                        <i class="fas fa-search"></i>
                        <p>No results found</p>
                        <span>Try adjusting your search terms</span>
                    </div>
                    <div id="results-loading" class="results-loading hidden">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>Searching...</span>
                    </div>
                </div>
            </div>
            
            <!-- Map Controls Overlay -->
            <div id="map-controls" class="map-controls">
                <!-- Basemap Toggle -->
                <div class="basemap-toggle">
                    <button id="btn-street-view" class="basemap-btn active" title="Street View">
                        <i class="fas fa-road"></i>
                        <span>Street</span>
                    </button>
                    <button id="btn-satellite-view" class="basemap-btn" title="Satellite View">
                        <i class="fas fa-satellite"></i>
                        <span>Satellite</span>
                    </button>
                </div>
                
                <!-- My Location Button -->
                <button id="btn-my-location" class="btn-map-action" title="Go to My Location">
                    <i class="fas fa-location-arrow"></i>
                </button>
                
                <!-- Reset View Button -->
                <button id="btn-reset-view" class="btn-map-action" title="Reset Map View">
                    <i class="fas fa-compress-arrows-alt"></i>
                </button>
            </div>
            
            <!-- Coordinates Display -->
            <div id="coordinates-display" class="coordinates-display">
                <i class="fas fa-crosshairs"></i>
                <span id="coords-text">Click on map to identify property</span>
            </div>
            
            <!-- Loading Overlay -->
            <div id="loading-overlay" class="loading-overlay hidden">
                <div class="loading-spinner">
                    <i class="fas fa-spinner fa-spin"></i>
                    <span>Fetching property data...</span>
                </div>
            </div>
            
            <!-- Error Toast -->
            <div id="error-toast" class="toast toast-error hidden">
                <i class="fas fa-exclamation-circle"></i>
                <span id="error-message">An error occurred</span>
                <button id="toast-close" class="toast-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- Success Toast -->
            <div id="success-toast" class="toast toast-success hidden">
                <i class="fas fa-check-circle"></i>
                <span id="success-message">Property saved successfully</span>
            </div>
            
            <!-- Sidebar Expand Button (when collapsed) -->
            <button id="sidebar-expand-btn" class="sidebar-expand-btn" aria-label="Open Saved Properties">
                <i class="fas fa-bookmark"></i>
                <span id="saved-badge" class="saved-badge hidden">0</span>
            </button>
        </main>
    </div>
    
    <!-- Property Popup Template (Hidden - Used by JavaScript) -->
    <template id="popup-template">
        <div class="property-popup">
            <div class="popup-header">
                <h3 class="popup-title">
                    <i class="fas fa-home"></i>
                    <span class="property-address">Loading...</span>
                </h3>
            </div>
            <div class="popup-content">
                <div class="popup-row">
                    <i class="fas fa-hashtag"></i>
                    <span class="popup-label">Tax Lot ID:</span>
                    <span class="popup-value taxlot-id">N/A</span>
                </div>
                <div class="popup-row">
                    <i class="fas fa-user"></i>
                    <span class="popup-label">Owner:</span>
                    <span class="popup-value owner-name">N/A</span>
                </div>
                <div class="popup-row">
                    <i class="fas fa-expand"></i>
                    <span class="popup-label">Acreage:</span>
                    <span class="popup-value acreage">N/A</span>
                </div>
                <div class="popup-row">
                    <i class="fas fa-map"></i>
                    <span class="popup-label">Map/Taxlot:</span>
                    <span class="popup-value map-taxlot">N/A</span>
                </div>
                <div class="popup-row">
                    <i class="fas fa-city"></i>
                    <span class="popup-label">City:</span>
                    <span class="popup-value city">N/A</span>
                </div>
                <div class="popup-row">
                    <i class="fas fa-mail-bulk"></i>
                    <span class="popup-label">Zip Code:</span>
                    <span class="popup-value zipcode">N/A</span>
                </div>
            </div>
            <div class="popup-actions">
                <button class="btn btn-save-property">
                    <i class="fas fa-bookmark"></i>
                    <span>Save Property</span>
                </button>
                <button class="btn btn-zoom-to">
                    <i class="fas fa-search-plus"></i>
                    <span>Zoom To</span>
                </button>
            </div>
        </div>
    </template>
    
    <!-- Saved Property Card Template (Hidden - Used by JavaScript) -->
    <template id="property-card-template">
        <div class="property-card" data-property-id="">
            <div class="property-card-header">
                <label class="checkbox-container">
                    <input type="checkbox" class="property-checkbox">
                    <span class="checkmark"></span>
                </label>
                <div class="property-card-title">
                    <i class="fas fa-home"></i>
                    <span class="card-address">N/A</span>
                </div>
                <button class="btn-remove-property" title="Remove Property">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="property-card-body">
                <div class="card-row">
                    <i class="fas fa-hashtag"></i>
                    <span class="card-taxlot">N/A</span>
                </div>
                <div class="card-row">
                    <i class="fas fa-expand"></i>
                    <span class="card-acreage">N/A</span>
                </div>
                <div class="card-row">
                    <i class="fas fa-user"></i>
                    <span class="card-owner">N/A</span>
                </div>
            </div>
            <div class="property-card-actions">
                <button class="btn btn-sm btn-zoom-to-saved">
                    <i class="fas fa-crosshairs"></i>
                    <span>Locate</span>
                </button>
            </div>
        </div>
    </template>
    
    <!-- Search Result Item Template -->
    <template id="search-result-template">
        <li class="result-item" data-lat="" data-lng="">
            <div class="result-icon">
                <i class="fas fa-map-marker-alt"></i>
            </div>
            <div class="result-content">
                <span class="result-title">Address</span>
                <span class="result-subtitle">Tax Lot: N/A</span>
            </div>
            <button class="result-action" title="Go to location">
                <i class="fas fa-chevron-right"></i>
            </button>
        </li>
    </template>
    
    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <i class="fas fa-exclamation-triangle"></i>
                <h3>Confirm Action</h3>
            </div>
            <div class="modal-body">
                <p id="confirm-message">Are you sure you want to proceed?</p>
            </div>
            <div class="modal-footer">
                <button id="btn-confirm-cancel" class="btn btn-secondary">
                    <i class="fas fa-times"></i>
                    <span>Cancel</span>
                </button>
                <button id="btn-confirm-ok" class="btn btn-danger">
                    <i class="fas fa-check"></i>
                    <span>Confirm</span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
            crossorigin="anonymous"></script>
    
    <!-- Custom Application Script -->
    <script src="script.js"></script>
</body>
</html>